"use strict";function _classCallCheck(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,n,e){return n&&_defineProperties(t.prototype,n),e&&_defineProperties(t,e),t}new(function(){function e(t,n){_classCallCheck(this,e),this.container=document.getElementById(t),this.shopList=document.createElement("table"),this.cartList=document.createElement("table"),this.products=n,this.cartProducts=this.getStorage()||[],this.container.appendChild(this.shopList),this.container.appendChild(this.cartList)}return _createClass(e,[{key:"setStorage",value:function(t){localStorage.setItem("cart",JSON.stringify(t))}},{key:"getStorage",value:function(){return JSON.parse(localStorage.getItem("cart"))||[]}},{key:"init",value:function(){this.initShopList(),0<this.getStorage().length&&this.renderCartList()}},{key:"initShopList",value:function(){var n="<thead>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<th>商品ID</th>\n\t\t\t\t\t\t\t<th>商品名称</th>\n\t\t\t\t\t\t\t<th>商品图片</th>\n\t\t\t\t\t\t\t<th>商品价格</th>\n\t\t\t\t\t\t\t<th>操作</th>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t   </thead>";n+="<tbody>",this.products.forEach(function(t){n+="<tr>\n\t\t\t\t\t<td>".concat(t.id,"</td>\n\t\t\t\t\t<td>").concat(t.name,'</td>\n\t\t\t\t\t<td><img src="').concat(t.pic,'"></td>\n\t\t\t\t\t<td>').concat(t.price,'</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<a href="javascript:;" class="addCart">点击获取快乐</a>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>')}),this.shopList.innerHTML=n,this.addCartListEvent()}},{key:"addCartListEvent",value:function(){var e=this;this.container.querySelectorAll(".addCart").forEach(function(t){t.onclick=function(){var t=this.parentNode.parentNode,n={name:t.children[1].innerHTML,price:t.children[3].innerHTML,pic:t.children[2].children[0].src,id:t.children[0].innerHTML};e.addToCartProducts(n),e.renderCartList()}})}},{key:"addToCartProducts",value:function(t){this.cartProducts=this.getStorage();for(var n=0;n<this.cartProducts.length;n++)if(this.cartProducts[n].id==t.id)return this.cartProducts[n].num++,void this.setStorage(this.cartProducts);t.num=1,this.cartProducts.push(t),this.setStorage(this.cartProducts)}},{key:"renderCartList",value:function(){var n="<thead>\n\t\t\t\t<tr>\n\t\t\t\t\t<th>商品ID</th>\n\t\t\t\t\t<th>商品名称</th>\n\t\t\t\t\t<th>商品图片</th>\n\t\t\t\t\t<th>商品价格</th>\n\t\t\t\t\t<th>商品数量</th>\n\t\t\t\t\t<th>操作</th>\n\t\t\t\t</tr>\n\t\t\t</thead>";n+="<tbody>",this.getStorage().forEach(function(t){n+="<tr>\n\t\t\t\t\t<td>".concat(t.id,"</td>\n\t\t\t\t\t<td>").concat(t.name,'</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<img src="').concat(t.pic,'">\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>').concat(t.price*t.num,'</td>\n\t\t\t\t\t<td class="change">\n\t\t\t\t\t\t<span class="jian">-</span>\n\t\t\t\t\t\t').concat(t.num,'\n\t\t\t\t\t\t<span class="jia">+</span>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<a href="javascript:;" class="del">剁手</a>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>')}),n+="</tbody>",this.cartList.innerHTML=n,this.deleteProductEvent(),this.changeNumEvent()}},{key:"changeNumEvent",value:function(){var e=this;this.container.querySelectorAll(".change").forEach(function(t){t.onclick=function(t){t.target;var n=this.parentNode.children[0].innerHTML;"jian"==t.target.className&&e.jianNum(n),"jia"==t.target.className&&(e.jiaNum(n),e.renderCartList())}})}},{key:"jianNum",value:function(t){for(var n=this.getStorage(),e=0;e<n.length;e++)if(n[e].id==t)return n[e].num--,this.setStorage(n),this.renderCartList(),n[e].num<=0?void this.deleteFromCartProducts(t):void 0}},{key:"jiaNum",value:function(t){for(var n=this.getStorage(),e=0;e<n.length;e++)if(n[e].id==t)return n[e].num++,void this.setStorage(n)}},{key:"deleteProductEvent",value:function(){var n=this;this.container.querySelectorAll(".del").forEach(function(t){t.onclick=function(){var t=this.parentNode.parentNode.children[0].innerHTML;n.deleteFromCartProducts(t)}})}},{key:"deleteFromCartProducts",value:function(n){this.cartProducts=this.getStorage(),this.cartProducts=this.cartProducts.filter(function(t){return t.id!=n}),this.setStorage(this.cartProducts),this.renderCartList(),this.getStorage().length<1&&(this.cartList.innerHTML="")}}]),e}())("container",[{name:"喝不起的特仑苏牛奶",pic:"./img/1.jpg",price:80,id:333333},{name:"不知名的三鹿奶粉",pic:"./img/3.jpg",price:100,id:666666},{name:"不知道被谁用过的原味面膜",pic:"./img/4.jpg",price:60,id:999999}]).init();var $inp=$("#txt")[0],$box=$(".boxTxt")[0],flag=!0;$inp.addEventListener("compositionstart",function(){flag=!1}),$inp.addEventListener("compositionend",function(){flag=!0}),$inp.oninput=function(){setTimeout(function(){if(flag){var t=$inp.value;$.ajax({dataType:"jsonp",url:"https://suggest.taobao.com/sug",data:{code:"utf-8",q:t,_ksTS:"1563970517892_385",k:1,area:"c2c",bucketid:10},success:function(t){var n=t.result,e="";n.forEach(function(t){e+="<li>"+t[0]+"</li>"}),$box.innerHTML=e}})}},0)};var str=document.cookie||"",arr=str.split("=");0!=arr[0]&&($(".uname")[0].style.display="block",$(".uname").html(arr[0]),$(".log-btn")[0].style.display="none",$(".reg-btn")[0].style.display="none");